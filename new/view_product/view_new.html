<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Product Details - Flower Knows</title>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
  <style>
    :root {
      --primary-color: #E6A6B0;
      --secondary-color: #F9C6CF;
      --accent-color: #6B4C3B;
      --background-color: #FFF9F9;
      --text-color: #6B4C3B;
      --text-light: #9b7c7c;
      --shadow-soft: 0 8px 32px rgba(107, 76, 59, 0.08);
      --shadow-medium: 0 12px 40px rgba(107, 76, 59, 0.12);
      --shadow-strong: 0 20px 60px rgba(107, 76, 59, 0.18);
      --gradient-pink: linear-gradient(135deg, #E6A6B0, #F9C6CF);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Playfair Display', serif;
      background-color: var(--background-color);
      color: var(--text-color);
      padding-top: 140px;
      line-height: 1.7;
    }

    .product-page {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 50px;
      max-width: 1200px;
      margin: 0 auto 60px;
      padding: 40px 30px;
      align-items: start;
    }

    .product-gallery {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .gallery-main {
      width: 100%;
      height: 500px;
      border-radius: 20px;
      overflow: hidden;
      position: relative;
      box-shadow: var(--shadow-medium);
    }

    .gallery-main img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .gallery-thumbnails {
      display: flex;
      gap: 12px;
      justify-content: center;
    }

    .thumbnail {
      width: 70px;
      height: 70px;
      border-radius: 12px;
      object-fit: cover;
      cursor: pointer;
      opacity: 0.7;
      transition: all 0.3s ease;
      border: 2px solid transparent;
    }

    .thumbnail.active,
    .thumbnail:hover {
      opacity: 1;
      border-color: var(--primary-color);
    }

    .product-details {
      padding: 20px 0;
    }

    .product-title {
      font-size: 36px;
      font-weight: 700;
      color: var(--text-color);
      margin-bottom: 12px;
    }

    .product-brand {
      color: var(--text-light);
      font-size: 18px;
      margin-bottom: 10px;
      font-style: italic;
    }

    .product-rating {
      display: flex;
      align-items: center;
      margin-bottom: 15px;
      gap: 10px;
    }

    .rating-stars {
      color: #ffc107;
    }

    .rating-value {
      color: var(--text-light);
    }

    .new-arrival {
      color: var(--primary-color);
      font-weight: 600;
      margin-bottom: 20px;
      display: inline-block;
      padding: 5px 10px;
      background: rgba(230, 166, 176, 0.1);
      border-radius: 4px;
    }

    .product-pricing {
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .original-price {
      text-decoration: line-through;
      color: var(--text-light);
      font-size: 20px;
    }

    .sale-price {
      font-size: 28px;
      font-weight: bold;
      color: var(--primary-color);
    }

    .shipping-note {
      color: var(--text-light);
      margin-bottom: 20px;
    }

    .product-options {
      margin-bottom: 20px;
    }

    .product-options label {
      display: block;
      font-weight: 600;
      margin-bottom: 8px;
    }

    .product-options select {
      width: 100%;
      padding: 12px 16px;
      border: 2px solid rgba(230, 166, 176, 0.3);
      border-radius: 10px;
      background: white;
      font-family: 'Playfair Display', serif;
      font-size: 16px;
    }

    .product-description {
      margin-bottom: 25px;
      line-height: 1.8;
    }

    .quantity-selector {
      display: flex;
      align-items: center;
      margin-bottom: 25px;
      width: 150px;
      border: 1px solid #ddd;
      border-radius: 5px;
      overflow: hidden;
    }

    .quantity-btn {
      width: 40px;
      height: 40px;
      background: #f5f5f5;
      border: none;
      font-size: 18px;
      cursor: pointer;
    }

    #quantity {
      width: 70px;
      height: 40px;
      text-align: center;
      border: none;
      border-left: 1px solid #ddd;
      border-right: 1px solid #ddd;
      font-family: 'Playfair Display', serif;
      font-size: 16px;
    }

    .btn-primary {
      width: 100%;
      padding: 15px;
      background: var(--gradient-pink);
      color: white;
      border: none;
      border-radius: 10px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      font-family: 'Playfair Display', serif;
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-medium);
    }

    .product-info-section {
      max-width: 1000px;
      margin: 60px auto;
      padding: 40px;
      background: rgba(255, 255, 255, 0.9);
      border-radius: 20px;
      box-shadow: var(--shadow-medium);
    }

    .product-info-section h2 {
      font-size: 32px;
      font-weight: 700;
      margin-bottom: 25px;
      text-align: center;
    }

    .product-info-section p {
      margin-bottom: 20px;
      line-height: 1.8;
    }

    .product-info-section ul {
      list-style: none;
      padding-left: 0;
      margin: 25px 0;
    }

    .product-info-section li {
      margin-bottom: 15px;
      padding-left: 30px;
      position: relative;
    }

    .product-info-section li::before {
      content: '‚ú¶';
      position: absolute;
      left: 0;
      color: var(--primary-color);
    }

    .loading {
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 60px 20px;
      flex-direction: column;
      gap: 20px;
    }

    .spinner {
      width: 40px;
      height: 40px;
      border: 4px solid rgba(230, 166, 176, 0.3);
      border-left-color: var(--primary-color);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .error-message {
      text-align: center;
      padding: 40px 20px;
      color: var(--primary-color);
      grid-column: 1 / -1;
    }

    .error-message a {
      color: var(--primary-color);
      text-decoration: none;
      margin-top: 15px;
      display: inline-block;
      font-weight: 600;
    }

    .error-message a:hover {
      text-decoration: underline;
    }

    .debug-info {
      background: #fff;
      padding: 20px;
      border-radius: 10px;
      margin: 20px 0;
      border-left: 4px solid var(--primary-color);
    }

    @media (max-width: 900px) {
      .product-page {
        grid-template-columns: 1fr;
        gap: 30px;
        padding: 20px 15px;
      }
      
      .gallery-main {
        height: 400px;
      }
    }
    /* ===== FIX FOR NAVIGATION OVERLAP ===== */
body {
  font-family: 'Playfair Display', serif;
  background-color: #FFF9F9;
  color: #6B4C3B;
  margin: 0;
  transition: all 0.3s ease;
  overflow-x: hidden;
}

/* Main content padding to prevent header overlap */
main {
  padding-top: 180px; /* Increased to account for header + navbar */
  min-height: 60vh;
  position: relative;
  z-index: 1;
}

/* Ensure header stays on top but doesn't overlap content */
#header-placeholder > header {
  position: fixed;
  top: 0;
  width: 100%;
  z-index: 1001;
  background-color: #FFF9F9;
  border-bottom: 1px solid #eee;
}

/* ===== IMPROVED PRODUCT INFO SECTIONS ===== */
.product-info-enhanced {
  max-width: 1200px;
  margin: 60px auto;
  padding: 0 20px;
}

.info-section {
  background: rgba(255, 255, 255, 0.95);
  border-radius: 20px;
  padding: 40px;
  margin-bottom: 30px;
  box-shadow: 0 8px 32px rgba(107, 76, 59, 0.08);
  border: 1px solid rgba(230, 166, 176, 0.2);
  animation: fadeInUp 0.6s ease-out;
}

@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(30px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.section-header {
  display: flex;
  align-items: center;
  margin-bottom: 30px;
  padding-bottom: 15px;
  border-bottom: 2px solid #FADADD;
}

.section-icon {
  width: 40px;
  height: 40px;
  background: var(--gradient-pink);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-right: 15px;
  color: white;
  font-size: 18px;
}

.section-title {
  font-size: 28px;
  font-weight: 700;
  color: #6B4C3B;
  margin: 0;
}

/* Benefits Grid */
.benefits-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 25px;
  margin-top: 20px;
}

.benefit-card {
  background: linear-gradient(135deg, #FFF9F9, #FFF0F2);
  padding: 25px;
  border-radius: 15px;
  border-left: 4px solid #E6A6B0;
  transition: all 0.3s ease;
  position: relative;
  overflow: hidden;
}

.benefit-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
  transition: left 0.5s ease;
}

.benefit-card:hover::before {
  left: 100%;
}

.benefit-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 10px 30px rgba(230, 166, 176, 0.2);
}

.benefit-icon {
  font-size: 24px;
  color: #E6A6B0;
  margin-bottom: 15px;
}

.benefit-title {
  font-size: 18px;
  font-weight: 600;
  color: #6B4C3B;
  margin-bottom: 10px;
}

.benefit-description {
  color: #8c7b7b;
  line-height: 1.6;
  font-size: 14px;
}

/* Ingredients List */
.ingredients-list {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 20px;
  margin-top: 20px;
}

.ingredient-item {
  background: rgba(255, 255, 255, 0.8);
  padding: 20px;
  border-radius: 12px;
  border: 1px solid rgba(230, 166, 176, 0.3);
  transition: all 0.3s ease;
  position: relative;
}

.ingredient-item:hover {
  background: white;
  box-shadow: 0 5px 20px rgba(230, 166, 176, 0.15);
  transform: translateY(-2px);
}

.ingredient-name {
  font-weight: 600;
  color: #6B4C3B;
  margin-bottom: 8px;
  display: flex;
  align-items: center;
  gap: 8px;
}

.ingredient-name::before {
  content: '‚ú¶';
  color: #E6A6B0;
  font-size: 14px;
}

.ingredient-purpose {
  color: #8c7b7b;
  font-size: 14px;
  line-height: 1.5;
}

/* Features List */
.features-list {
  display: flex;
  flex-direction: column;
  gap: 15px;
  margin-top: 20px;
}

.feature-item {
  display: flex;
  align-items: flex-start;
  gap: 15px;
  padding: 15px;
  background: rgba(255, 255, 255, 0.7);
  border-radius: 10px;
  transition: all 0.3s ease;
}

.feature-item:hover {
  background: white;
  transform: translateX(10px);
}

.feature-badge {
  background: var(--gradient-pink);
  color: white;
  width: 24px;
  height: 24px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 12px;
  font-weight: bold;
  flex-shrink: 0;
}

.feature-content h4 {
  margin: 0 0 5px 0;
  color: #6B4C3B;
  font-size: 16px;
}

.feature-content p {
  margin: 0;
  color: #8c7b7b;
  font-size: 14px;
  line-height: 1.5;
}

/* ===== ANIMATIONS ===== */
@keyframes pulse {
  0% { transform: scale(1); }
  50% { transform: scale(1.05); }
  100% { transform: scale(1); }
}

@keyframes slideInLeft {
  from {
    opacity: 0;
    transform: translateX(-30px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

@keyframes slideInRight {
  from {
    opacity: 0;
    transform: translateX(30px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

.animate-pulse {
  animation: pulse 2s infinite;
}

.animate-slide-left {
  animation: slideInLeft 0.6s ease-out;
}

.animate-slide-right {
  animation: slideInRight 0.6s ease-out;
}

/* ===== RESPONSIVE IMPROVEMENTS ===== */
@media (max-width: 768px) {
  main {
    padding-top: 160px; /* Adjusted for mobile */
  }
  
  .product-info-enhanced {
    padding: 0 15px;
  }
  
  .info-section {
    padding: 25px 20px;
    margin-bottom: 20px;
  }
  
  .section-title {
    font-size: 24px;
  }
  
  .benefits-grid {
    grid-template-columns: 1fr;
    gap: 20px;
  }
  
  .benefit-card {
    padding: 20px;
  }
  
  .ingredients-list {
    grid-template-columns: 1fr;
  }
  
  .feature-item {
    padding: 12px;
  }
}

@media (max-width: 480px) {
  main {
    padding-top: 140px; /* Further adjustment for small mobile */
  }
  
  .info-section {
    padding: 20px 15px;
  }
  
  .section-header {
    flex-direction: column;
    text-align: center;
    gap: 10px;
  }
  
  .section-icon {
    margin-right: 0;
  }
}
  </style>
</head>
<body>
  <!-- Header Placeholder -->
  <div id="header-placeholder">
    <div class="loading">
      <div class="spinner"></div>
      <span>Loading header...</span>
    </div>
  </div>

  <!-- Product Page Content -->
  <main class="product-page" id="productPage">
    <div class="loading">
      <div class="spinner"></div>
      <p>ƒêang t·∫£i th√¥ng tin s·∫£n ph·∫©m...</p>
    </div>
  </main>

  <!-- Product Info Sections -->
  <section class="product-info-section" id="productInfoSection"></section>

  <!-- Footer Placeholder -->
  <div id="footer-placeholder">
    <div class="loading">
      <div class="spinner"></div>
      <span>Loading footer...</span>
    </div>
  </div>

  <script>
    // ==================== DEBUG MODE ====================
    const DEBUG = true;

    // ==================== CONFIGURATION ====================
    const CONFIG = {
      // Th·ª≠ c√°c ƒë∆∞·ªùng d·∫´n kh√°c nhau
      jsonPaths: [
        'products_view.json',
        './products_view.json', 
        '../products_view.json',
        'new/products_view.json',
        '../new/products.json',
        'data/products_view.json'
      ],
      headerPath: './header.html',
      footerPath: './footer.html',
      productsPage: '../new/new.html'
    };

    // ==================== UTILITY FUNCTIONS ====================
    function debugLog(message, data = null) {
      if (DEBUG) {
        console.log(`üîç ${message}`, data || '');
      }
    }

    function showError(message, details = '') {
      console.error('‚ùå L·ªói:', message, details);
      const productPage = document.getElementById('productPage');
      productPage.innerHTML = `
        <div class="error-message">
          <h2>L·ªói khi t·∫£i trang</h2>
          <p>${message}</p>
          ${details ? `<div class="debug-info"><strong>Chi ti·∫øt:</strong> ${details}</div>` : ''}
          <div class="debug-info">
            <strong>URL hi·ªán t·∫°i:</strong> ${window.location.href}<br>
            <strong>Product ID t·ª´ URL:</strong> ${new URLSearchParams(window.location.search).get('id') || 'Kh√¥ng c√≥'}
          </div>
          <a href="${CONFIG.productsPage}">‚Üê Quay l·∫°i trang s·∫£n ph·∫©m</a>
        </div>
      `;
    }

    function showLoading() {
      const productPage = document.getElementById('productPage');
      productPage.innerHTML = `
        <div class="loading" style="grid-column: 1 / -1;">
          <div class="spinner"></div>
          <p>ƒêang t·∫£i th√¥ng tin s·∫£n ph·∫©m...</p>
        </div>
      `;
    }

    // ==================== CORE FUNCTIONS ====================
    function getProductIdFromURL() {
      const urlParams = new URLSearchParams(window.location.search);
      const productId = urlParams.get('id');
      
      debugLog('Product ID t·ª´ URL:', productId);
      
      if (!productId) {
        showError('Thi·∫øu th√¥ng tin s·∫£n ph·∫©m', 'Kh√¥ng t√¨m th·∫•y ID s·∫£n ph·∫©m trong URL');
        return null;
      }
      
      return productId;
    }

    async function tryFetchMultiplePaths(paths) {
      for (const path of paths) {
        try {
          debugLog('Th·ª≠ t·∫£i t·ª´ ƒë∆∞·ªùng d·∫´n:', path);
          const response = await fetch(path);
          
          if (response.ok) {
            const content = await response.text();
            debugLog(`‚úÖ T·∫£i th√†nh c√¥ng t·ª´: ${path}`);
            return { success: true, path: path, content: content };
          }
        } catch (error) {
          debugLog(`‚ùå Kh√¥ng th·ªÉ t·∫£i t·ª´ ${path}:`, error.message);
        }
      }
      
      return { success: false, error: 'Kh√¥ng th·ªÉ t·∫£i t·ª´ b·∫•t k·ª≥ ƒë∆∞·ªùng d·∫´n n√†o' };
    }

    async function loadProductData() {
      debugLog('B·∫Øt ƒë·∫ßu t·∫£i d·ªØ li·ªáu s·∫£n ph·∫©m...');
      
      const result = await tryFetchMultiplePaths(CONFIG.jsonPaths);
      
      if (!result.success) {
        throw new Error(result.error);
      }

      try {
        const data = JSON.parse(result.content);
        debugLog('ƒê√£ parse JSON th√†nh c√¥ng', { 
          hasProducts: !!data.products, 
          productCount: data.products ? data.products.length : 0 
        });

        if (!data.products || !Array.isArray(data.products)) {
          throw new Error('ƒê·ªãnh d·∫°ng JSON kh√¥ng h·ª£p l·ªá - thi·∫øu m·∫£ng products');
        }

        if (data.products.length === 0) {
          throw new Error('Kh√¥ng c√≥ s·∫£n ph·∫©m n√†o trong file JSON');
        }

        // Log danh s√°ch s·∫£n ph·∫©m ƒë·ªÉ debug
        debugLog('Danh s√°ch s·∫£n ph·∫©m:', data.products.map(p => ({ id: p.id, name: p.name })));

        return data.products;
      } catch (error) {
        throw new Error(`L·ªói parse JSON: ${error.message}`);
      }
    }

    function findProductById(products, productId) {
      debugLog(`T√¨m s·∫£n ph·∫©m v·ªõi ID: ${productId}`);
      
      // Th·ª≠ t√¨m v·ªõi nhi·ªÅu c√°ch so s√°nh
      let product = products.find(p => p.id == productId); // So s√°nh l·ªèng l·∫ªo
      
      if (!product) {
        product = products.find(p => p.id === parseInt(productId)); // So s√°nh ch·∫∑t ch·∫Ω
      }
      
      if (!product) {
        product = products.find(p => p.id.toString() === productId); // So s√°nh string
      }

      debugLog('K·∫øt qu·∫£ t√¨m ki·∫øm:', product ? `T√¨m th·∫•y: ${product.name}` : 'Kh√¥ng t√¨m th·∫•y');
      
      return product;
    }

    function generateStarRating(rating) {
      const fullStars = Math.floor(rating);
      const hasHalfStar = rating % 1 !== 0;
      let stars = '';
      
      for (let i = 0; i < fullStars; i++) {
        stars += '<i class="fas fa-star"></i>';
      }
      
      if (hasHalfStar) {
        stars += '<i class="fas fa-star-half-alt"></i>';
      }
      
      const emptyStars = 5 - Math.ceil(rating);
      for (let i = 0; i < emptyStars; i++) {
        stars += '<i class="far fa-star"></i>';
      }
      
      return stars;
    }

    // ==================== DISPLAY FUNCTIONS ====================
    function displayProduct(product) {
      if (!product) {
        showError('S·∫£n ph·∫©m kh√¥ng t·ªìn t·∫°i', `Kh√¥ng t√¨m th·∫•y s·∫£n ph·∫©m v·ªõi ID: ${new URLSearchParams(window.location.search).get('id')}`);
        return;
      }

      debugLog('B·∫Øt ƒë·∫ßu hi·ªÉn th·ªã s·∫£n ph·∫©m:', product.name);

      const productPage = document.getElementById('productPage');
      
      try {
        // T·∫°o HTML cho s·∫£n ph·∫©m
        productPage.innerHTML = `
          <div class="product-gallery">
            <div class="gallery-main">
              <img src="${product.images?.[0] || 'https://via.placeholder.com/600x600/FFF9F9/E6A6B0?text=·∫¢nh+s·∫£n+ph·∫©m'}" 
                   alt="${product.name}" 
                   id="main-image">
            </div>
            <div class="gallery-thumbnails" id="galleryThumbnails">
              ${(product.images || []).map((image, index) => `
                <img src="${image}" 
                     alt="Image ${index + 1}" 
                     class="thumbnail ${index === 0 ? 'active' : ''}">
              `).join('')}
            </div>
          </div>

          <div class="product-details">
            <h1 class="product-title">${product.name || 'Kh√¥ng c√≥ t√™n'}</h1>
            <div class="product-brand">${product.brand || 'Kh√¥ng c√≥ th∆∞∆°ng hi·ªáu'}</div>
            
            <div class="product-rating">
              <div class="rating-stars">
                ${generateStarRating(product.rating || 0)}
              </div>
              <div class="rating-value">${(product.rating || 0).toFixed(1)}/5</div>
            </div>
            
            ${product.isNew ? `<p class="new-arrival">New Arrival - Launched: ${product.launchDate ? new Date(product.launchDate).toLocaleDateString('vi-VN') : 'Kh√¥ng c√≥ ng√†y'}</p>` : ''}

            <div class="product-pricing">
              ${product.originalPrice ? `<span class="original-price">$${(product.originalPrice || 0).toFixed(2)}</span>` : ''}
              <span class="sale-price">$${(product.price || 0).toFixed(2)}</span>
            </div>

            <p class="shipping-note">Shipping calculated at checkout.</p>

            ${product.shades ? `
            <div class="product-options">
              <label for="product-variant">Shade</label>
              <select id="product-variant">
                ${product.shades.map(shade => `
                  <option value="${shade.value}">${shade.label}</option>
                `).join('')}
              </select>
            </div>
            ` : ''}

            <p class="product-description">
              ${product.detailedDescription || product.description || 'Kh√¥ng c√≥ m√¥ t·∫£'}
            </p>

            <div class="quantity-selector">
              <button class="quantity-btn" id="decrease-qty">-</button>
              <input type="number" id="quantity" value="1" min="1">
              <button class="quantity-btn" id="increase-qty">+</button>
            </div>

            <button class="btn-primary" id="addToCartBtn">ADD TO CART</button>
          </div>
        `;

        // Hi·ªÉn th·ªã th√¥ng tin m·ªü r·ªông
        displayExtendedInfo(product);
        
        // Kh·ªüi t·∫°o s·ª± ki·ªán
        initializeProductEvents(product);

        debugLog('‚úÖ Hi·ªÉn th·ªã s·∫£n ph·∫©m th√†nh c√¥ng');

      } catch (error) {
        showError('L·ªói khi hi·ªÉn th·ªã s·∫£n ph·∫©m', error.message);
      }
    }

    function displayExtendedInfo(product) {
      const infoSection = document.getElementById('productInfoSection');
      
      if (!product.ingredientsInfo && !product.shadeInfo && !product.benefits) {
        infoSection.innerHTML = '<p>Kh√¥ng c√≥ th√¥ng tin b·ªï sung cho s·∫£n ph·∫©m n√†y.</p>';
        return;
      }

      let html = '';

      // Th√¥ng tin th√†nh ph·∫ßn
      if (product.ingredientsInfo || product.ingredientList) {
        html += `
          <h2>Ingredients & Texture</h2>
          ${product.ingredientsInfo ? `<p>${product.ingredientsInfo}</p>` : ''}
          ${product.ingredientList ? `
            <ul>
              ${product.ingredientList.map(item => {
                const [key, ...valueParts] = item.split(':');
                const value = valueParts.join(':').trim();
                return `<li><strong>${key.trim()}:</strong> ${value}</li>`;
              }).join('')}
            </ul>
          ` : ''}
          ${product.textureInfo ? `<p>${product.textureInfo}</p>` : ''}
        `;
      }

      // Th√¥ng tin m√†u s·∫Øc
      if (product.shadeInfo || product.shadeList) {
        html += `
          <h2>Shade Range & Undertones</h2>
          ${product.shadeInfo ? `<p>${product.shadeInfo}</p>` : ''}
          ${product.shadeList ? `
            <ul>
              ${product.shadeList.map(item => {
                const [key, ...valueParts] = item.split(':');
                const value = valueParts.join(':').trim();
                return `<li><strong>${key.trim()}:</strong> ${value}</li>`;
              }).join('')}
            </ul>
          ` : ''}
        `;
      }

      // L·ª£i √≠ch
      if (product.benefits) {
        html += `
          <h2>Benefits</h2>
          <ul>
            ${product.benefits.map(benefit => {
              const [key, ...valueParts] = benefit.split(':');
              const value = valueParts.join(':').trim();
              return `<li><strong>${key.trim()}:</strong> ${value}</li>`;
            }).join('')}
          </ul>
        `;
      }

      infoSection.innerHTML = html;
    }

    function initializeProductEvents(product) {
      // S·ª± ki·ªán thumbnail
      const thumbnails = document.querySelectorAll('.thumbnail');
      const mainImage = document.getElementById('main-image');
      
      thumbnails.forEach(thumb => {
        thumb.addEventListener('click', function() {
          mainImage.style.opacity = '0.5';
          setTimeout(() => {
            mainImage.src = this.src;
            mainImage.style.opacity = '1';
          }, 200);
          
          document.querySelectorAll('.thumbnail').forEach(t => t.classList.remove('active'));
          this.classList.add('active');
        });
      });

      // S·ª± ki·ªán quantity selector
      const decreaseBtn = document.getElementById('decrease-qty');
      const increaseBtn = document.getElementById('increase-qty');
      const quantityInput = document.getElementById('quantity');
      
      if (decreaseBtn && increaseBtn && quantityInput) {
        decreaseBtn.addEventListener('click', function() {
          let value = parseInt(quantityInput.value);
          if (value > 1) {
            quantityInput.value = value - 1;
          }
        });

        increaseBtn.addEventListener('click', function() {
          let value = parseInt(quantityInput.value);
          if (value < 999) {
            quantityInput.value = value + 1;
          }
        });
      }

      // S·ª± ki·ªán add to cart
      const addToCartBtn = document.getElementById('addToCartBtn');
      if (addToCartBtn) {
        addToCartBtn.addEventListener('click', function() {
          this.textContent = '‚úì ADDED TO CART';
          this.style.background = 'var(--secondary-color)';
          setTimeout(() => {
            this.textContent = 'ADD TO CART';
            this.style.background = 'var(--gradient-pink)';
          }, 2000);
        });
      }
    }

    // ==================== HEADER/FOOTER LOADING ====================
    async function loadHeaderFooter() {
      debugLog('B·∫Øt ƒë·∫ßu t·∫£i header v√† footer...');
      
      try {
        // T·∫£i header
        const headerResponse = await fetch(CONFIG.headerPath);
        if (headerResponse.ok) {
          const headerHTML = await headerResponse.text();
          document.getElementById('header-placeholder').innerHTML = headerHTML;
          debugLog('‚úÖ Header loaded');
        } else {
          throw new Error(`HTTP ${headerResponse.status}`);
        }
      } catch (error) {
        debugLog('‚ùå L·ªói t·∫£i header:', error.message);
        document.getElementById('header-placeholder').innerHTML = `
          <div style="padding: 20px; text-align: center; color: var(--text-light);">
            <p>Header kh√¥ng kh·∫£ d·ª•ng</p>
          </div>
        `;
      }

      try {
        // T·∫£i footer
        const footerResponse = await fetch(CONFIG.footerPath);
        if (footerResponse.ok) {
          const footerHTML = await footerResponse.text();
          document.getElementById('footer-placeholder').innerHTML = footerHTML;
          debugLog('‚úÖ Footer loaded');
        } else {
          throw new Error(`HTTP ${footerResponse.status}`);
        }
      } catch (error) {
        debugLog('‚ùå L·ªói t·∫£i footer:', error.message);
        document.getElementById('footer-placeholder').innerHTML = `
          <div style="padding: 20px; text-align: center; color: var(--text-light);">
            <p>Footer kh√¥ng kh·∫£ d·ª•ng</p>
          </div>
        `;
      }
    }

    // ==================== MAIN INITIALIZATION ====================
    async function initializePage() {
      debugLog('üöÄ B·∫Øt ƒë·∫ßu kh·ªüi t·∫°o trang...');
      
      try {
        // T·∫£i header v√† footer
        await loadHeaderFooter();
        
        // L·∫•y ID s·∫£n ph·∫©m t·ª´ URL
        const productId = getProductIdFromURL();
        if (!productId) return;
        
        // Hi·ªÉn th·ªã loading
        showLoading();
        
        // T·∫£i d·ªØ li·ªáu s·∫£n ph·∫©m
        debugLog('üîÑ ƒêang t·∫£i d·ªØ li·ªáu s·∫£n ph·∫©m...');
        const products = await loadProductData();
        
        if (!products) {
          showError('Kh√¥ng th·ªÉ t·∫£i d·ªØ li·ªáu s·∫£n ph·∫©m');
          return;
        }

        // T√¨m v√† hi·ªÉn th·ªã s·∫£n ph·∫©m
        debugLog(`üîç ƒêang t√¨m s·∫£n ph·∫©m v·ªõi ID: ${productId}`);
        const product = findProductById(products, productId);
        displayProduct(product);
        
        // C·∫≠p nh·∫≠t ti√™u ƒë·ªÅ trang
        if (product) {
          document.title = `${product.name} - ${product.brand} | Flower Knows`;
        }
        
        debugLog('‚úÖ Kh·ªüi t·∫°o trang ho√†n t·∫•t');

      } catch (error) {
        console.error('üí• L·ªói kh·ªüi t·∫°o trang:', error);
        showError('L·ªói khi t·∫£i trang', error.message);
      }
    }

    // ==================== ERROR HANDLING ====================
    window.addEventListener('error', function(e) {
      console.error('üö® L·ªói to√†n c·ª•c:', e.error);
    });

    window.addEventListener('unhandledrejection', function(e) {
      console.error('üö® Promise b·ªã t·ª´ ch·ªëi:', e.reason);
    });
    

    // Kh·ªüi ch·∫°y
    document.addEventListener('DOMContentLoaded', initializePage);
  </script>
</body>
</html>