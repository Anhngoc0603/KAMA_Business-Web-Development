<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sakura High-End Beauty</title>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
</head>
<body>
<header>
  <style>
    body {
      font-family: 'Playfair Display', serif;
      background-color: #FFF9F9;
      color: #6B4C3B;
      margin: 0;
      padding-top: 0;
      transition: all 0.3s ease;
      overflow-x: hidden;
      overflow-y: auto;
    }

    /* Announcement */
    .announcement-container {
      position: relative;
      background-color: #e89a98;
      color: white;
      height: 30px;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      font-family: "Times New Roman", serif;
    }
    .announcement-wrapper {
      display: flex;
      width: 100%;
      transition: transform 0.8s ease-in-out;
    }
    .announcement-slide {
      flex: 0 0 100%;
      font-size: 13px;
      font-weight: 400;
      text-align: center;
      white-space: nowrap;
    }

    /* Header */
    header {
      position: fixed;
      top: 0;
      width: 100%;
      z-index: 1001;
      background-color: #FFF9F9;
      border-bottom: 1px solid #eee;
    }

    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 50px;
      transition: box-shadow 0.3s ease, background-color 0.3s ease, backdrop-filter 0.3s ease;
    }
    .header:hover {
      background-color: rgba(255, 249, 249, 0.8);
      backdrop-filter: blur(10px);
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
    }

    .menu-toggler {
      display: none;
      background: none;
      border: none;
      font-size: 18px;
      cursor: pointer;
      padding: 5px;
      width: 20px;
      height: 20px;
      transition: opacity 0.3s ease;
    }
    .menu-toggler img {
      width: 100%;
      height: 100%;
      object-fit: contain;
    }
    .menu-toggler:hover {
      opacity: 0.7;
    }

    .logo {
      width: 200px;
      height: auto;
      display: flex;
      align-items: center;
      justify-content: space-between;
      transition: transform 0.3s ease;
      cursor: pointer;
    }
    .logo:hover {
      transform: scale(1.05);
    }

    /* Navigation */
    nav {
      display: flex;
      gap: 25px;
      align-items: center;
    }
    nav a img {
      width: 28px;
      height: 28px;
      opacity: 0.8;
      object-fit: contain;
      cursor: pointer;
      transition: opacity 0.3s ease, transform 0.3s ease;
    }
    nav a:hover img {
      opacity: 0.6;
      transform: scale(1.1);
    }

    .search {
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
      flex: 1;
      max-width: 250px;
      margin-left: 30px;
      margin-right: 30px;
    }
    .search .icon {
      position: absolute;
      left: 12px;
      width: 18px;
      height: 18px;
      opacity: 0.6;
      transition: opacity 0.3s ease;
    }
    .search .icon:hover {
      opacity: 0.9;
    }
    .search input {
      width: 100%;
      padding: 8px 12px 8px 38px;
      border: 1px solid #828282;
      border-radius: 20px;
      outline: none;
      background-color: #fff;
      transition: all 0.2s ease, box-shadow 0.3s ease;
      font-family: 'Playfair Display', serif;
    }
    .search input::placeholder {
      font-family: 'Playfair Display', serif;
      color: #9b7c7c;
      opacity: 0.7;
    }
    .search input:focus {
      border-color: #E6A6B0;
      box-shadow: 0 0 6px rgba(230, 166, 176, 0.5);
    }

    /* Navbar */
    .navbar {
      display: flex;
      justify-content: center;
      gap: 60px;
      padding: 15px 0;
      transition: all 0.3s ease;
      background-color: #FFF9F9;
    }

    .navbar a {
      text-decoration: none;
      color: #6B4C3B;
      letter-spacing: 2px;
      position: relative;
      font-size: 16px;
      transition: color 0.3s ease, border-bottom-color 0.3s ease;
    }
    .navbar a:hover {
      opacity: 0.8;
      border-bottom: 2px solid #E6A6B0;
    }

    .shop-all {
      position: relative;
      cursor: pointer;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* Menu categories for desktop */
    .menu-categories {
      position: absolute;
      left: 0;
      top: 100%;
      width: 100vw;
      background: #FFF9F9;
      border-top: 2px solid #E6A6B0;
      padding: 30px 60px;
      display: none;
      z-index: 1010;
      box-sizing: border-box;
      margin-left: calc(-50vw + 50%);
      animation: fadeIn 0.3s ease-out;
    }

    .menu-categories.active,
    .shop-all:hover + .menu-categories,
    .menu-categories:hover {
      display: block;
    }

    /* Grid for desktop */
    .categories-wrapper {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 40px;
      max-width: 1200px;
      margin: 0 auto;
    }

    /* Each category */
    .category {
      display: flex;
      flex-direction: column;
      padding: 8px 0;
      width: 100%;
    }

    .category-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      width: 100%;
    }

    .category h3 {
      margin-bottom: 8px;
      font-size: 16px;
      color: #E6A6B0;
      border-bottom: 1px solid #FADADD;
      padding-bottom: 4px;
    }

    .category h3 a {
      text-decoration: none;
      color: #E6A6B0;
      transition: color 0.3s ease;
    }

    .category h3 a:hover {
      color: #F9C6CF;
    }

    .next-btn {
      background: none;
      border: none;
      cursor: pointer;
      padding: 6px;
      border-radius: 50%;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .next-btn img {
      width: 16px;
      height: 16px;
      opacity: 0.7;
    }

    .next-btn:hover {
      background: #FADADD;
      transform: scale(1.1);
    }

    .category.active .next-btn {
      transform: rotate(90deg);
    }

    /* Product list for desktop */
    .product-list {
      list-style: none;
      padding: 0;
      margin: 0;
      width: 100%;
      padding-right: 8px;
    }

    /* Ẩn nút Next và hiển thị product-list luôn trên PC */
    @media (min-width: 901px) {
      .next-btn {
        display: none; /* Ẩn nút Next trên PC */
      }
      .product-list {
        display: block !important; /* Hiển thị product-list luôn */
        max-height: none; /* Không giới hạn chiều cao */
        overflow-y: visible; /* Không cần scroll */
      }
      .category.active .next-btn {
        transform: none; /* Không xoay nút trên PC */
      }
    }

    /* Custom scrollbar for desktop (giữ nhưng không cần trên PC) */
    .product-list::-webkit-scrollbar {
      width: 6px;
    }
    .product-list::-webkit-scrollbar-thumb {
      background-color: rgba(230, 166, 176, 0.5);
      border-radius: 3px;
    }
    .product-list::-webkit-scrollbar-track {
      background-color: transparent;
    }

    .product-list li {
      padding: 6px 0;
      font-size: 14px;
      color: #6B4C3B;
      cursor: pointer;
      transition: all 0.2s ease;
      border-bottom: 1px solid rgba(230, 166, 176, 0.1);
      position: relative;
    }

    .product-list li:hover {
      color: #E6A6B0;
      padding-left: 8px;
      background-color: rgba(250, 218, 221, 0.3);
    }

    .shop-all-link {
      font-weight: bold;
      color: #E6A6B0 !important;
    }

    .back-btn {
      display: none;
      align-items: center;
      justify-content: center;
      background: #E6A6B0;
      color: white;
      border: none;
      padding: 12px 20px;
      border-radius: 8px;
      margin-bottom: 15px;
      font-size: 16px;
      font-family: 'Playfair Display', serif !important;
      width: 100%;
      cursor: pointer;
      gap: 8px;
      transition: all 0.3s ease;
    }

    .back-btn:hover {
      background: #F9C6CF;
      transform: translateY(-2px);
    }

    .back-btn img {
      width: 18px;
      height: 18px;
      filter: brightness(0) invert(1);
    }

    /* Search Overlay */
    .search-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      z-index: 2000;
      justify-content: center;
      align-items: center;
    }
    .search-overlay.active {
      display: flex;
    }
    .search-wrapper {
      position: relative;
      width: 90%;
      max-width: 600px;
      background: #FFF9F9;
      padding: 16px;
      border-radius: 20px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
    }
    .search-input {
      width: 100%;
      padding: 9.6px 16px;
      border-radius: 12px;
      border: 1px solid #F9C6CF;
      font-size: 16px;
      font-family: 'Playfair Display', serif;
      box-sizing: border-box;
    }
    .close-search {
      position: absolute;
      top: 8px;
      right: 8px;
      background: none;
      border: none;
      font-size: 24px;
      color: #6B4C3B;
      cursor: pointer;
      transition: color 0.3s ease;
    }
    .close-search:hover {
      color: #E6A6B0;
    }

    /* Mobile Styles for Header */
    @media (max-width: 900px) {
      body {
        padding-top: 120px;
      }

      .header {
        padding: 10px 20px;
      }

      .menu-toggler {
        display: block !important;
        width: 30px;
        height: 30px;
      }

      nav {
        gap: 20px;
      }
      
      nav a img {
        width: 32px;
        height: 32px;
      }

      .search {
        margin-left: 15px;
        margin-right: 15px;
        max-width: 200px;
      }

      .navbar {
        display: none !important;
        flex-direction: column;
        align-items: flex-start;
        background-color: #FFF9F9;
        border-top: 1px solid #ddd;
        padding: 20px;
        gap: 15px;
        position: absolute;
        top: 100%;
        left: 0;
        width: 100%;
        box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        z-index: 1010;
        margin-top: 0;
        max-height: 80vh;
        overflow-y: auto;
      }

      .navbar.active {
        display: flex !important;
      }

      .shop-all {
        width: 100%;
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 10px 0;
      }

      .shop-all::after {
        content: "▼";
        font-size: 12px;
        transition: transform 0.3s ease;
      }

      .shop-all.active::after {
        transform: rotate(180deg);
      }

      .menu-categories {
        position: static;
        width: 100%;
        display: none;
        flex-direction: column;
        gap: 15px;
        padding: 20px;
        margin: 10px 0;
        background: rgba(250, 218, 221, 0.2);
        border: 1px solid #FADADD;
        border-radius: 10px;
        max-height: none;
        overflow-y: visible;
      }

      .menu-categories.active {
        display: flex !important;
      }

      .back-btn {
        display: none;
        font-family: 'Playfair Display', serif !important;
      }

      .categories-wrapper {
        display: flex;
        flex-direction: column;
        gap: 15px;
        width: 100%;
      }

      .category {
        width: 100%;
        padding: 12px;
        background: #FFF9F9;
        border-radius: 8px;
        border: 1px solid #FADADD;
        display: flex;
        flex-direction: column;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .category:hover {
        background: rgba(230, 166, 176, 0.1);
        transform: translateX(5px);
      }

      .category-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        width: 100%;
      }

      .category h3 {
        font-size: 19.2px;
        margin-bottom: 0;
        padding-bottom: 0;
      }

      .next-btn {
        display: flex;
        background: none;
        border: none;
        cursor: pointer;
        padding: 8px;
        border-radius: 50%;
        transition: all 0.3s ease;
        align-items: center;
        justify-content: center;
      }

      .next-btn:hover {
        background: #FADADD;
        transform: scale(1.1);
      }

      .next-btn img {
        width: 20px;
        height: 20px;
        opacity: 0.7;
      }

      .product-list {
        display: none;
        max-height: 150px;
        background-color: #FFF9F9;
        border: 1px solid #FADADD;
        border-radius: 6px;
        padding: 10px;
        width: 100%;
        overflow-y: auto;
        margin-top: 10px;
        box-sizing: border-box;
      }

      .category.active .product-list {
        display: block !important;
      }

      .category.active .next-btn {
        transform: rotate(90deg);
      }

      .product-list::-webkit-scrollbar {
        width: 6px;
      }
      
      .product-list::-webkit-scrollbar-thumb {
        background-color: #E6A6B0;
        border-radius: 3px;
      }
      
      .product-list::-webkit-scrollbar-track {
        background-color: #FADADD;
        border-radius: 3px;
      }

      .product-list li {
        padding: 8px 10px;
        font-size: 14.4px;
        border-bottom: 1px solid rgba(230, 166, 176, 0.3);
        margin-bottom: 3px;
        cursor: pointer;
        transition: all 0.2s ease;
      }

      .product-list li:last-child {
        border-bottom: none;
        margin-bottom: 0;
      }

      .product-list li:hover {
        padding-left: 12px;
        background-color: rgba(230, 166, 176, 0.2);
        color: #E6A6B0;
      }
    }

    @media (max-width: 480px) {
      body {
        padding-top: 110px;
      }

      .header {
        padding: 8px 15px;
      }

      nav {
        gap: 15px;
      }

      nav a img {
        width: 28px;
        height: 28px;
      }

      .search {
        max-width: 150px;
        margin-left: 10px;
        margin-right: 10px;
      }

      .logo {
        width: 150px;
      }

      .menu-toggler {
        width: 25px;
        height: 25px;
      }

      .navbar {
        padding: 15px;
      }

      .menu-categories {
        padding: 15px;
      }

      .category {
        padding: 12px;
      }

      .product-list {
        max-height: 100px;
      }

      .product-list li {
        padding: 6px 8px;
        font-size: 13.6px;
      }
    }
  </style>

  <!-- HTML của header -->
  <div class="announcement-container">
    <div class="announcement-wrapper" id="announcementWrapper">
      <div class="announcement-slide">Free Shipping On Orders Over $100</div>
      <div class="announcement-slide">Spend $100+, Get a Free Product Randomly!</div>
    </div>
  </div>
  <div class="header">
    <button class="menu-toggler" id="menu-toggler">
      <img src="../1 (1).Final/images/nav.png" alt="Menu Toggler">
    </button>
    <a href="../1.homepage/html/landingpage.html"><img src="../1 (1).Final/images/LOGO.png" alt="Logo" class="logo"></a>
    <nav>
      <div class="search">
        <img src="../1 (1).Final/images/find.png" alt="Search" class="icon">
        <input type="text" placeholder="Search for..." id="search-input-main">
      </div>
      <a href="#"><img src="../1 (1).Final/images/account.png" alt="Account"></a>
      <a href="#"><img src="../1 (1).Final/images/contact.png" alt="Contact"></a>
      <a href="../cart/cart.html" class="cart-icon"><img src="../1 (1).Final/images/shopping.png" alt="Shopping"></a>
    </nav>
  </div>
  <nav class="navbar" id="navbar">
    <a href="#">NEW</a>
    <a href="#">COLLECTIONS</a>
    <a href="#">BEST SELLERS</a>
    <a href="#">SALE</a>
    <a href="#" class="shop-all">CATEGORIES</a>
    <div class="menu-categories">
      <button class="back-btn">
        <img src="../1 (1).Final/images/back-arrow.png" alt="Back"> Back to Menu
      </button>
      <div class="categories-wrapper">
        <div class="category" data-category="Face">
          <div class="category-header">
            <h3><a href="#">FACE</a></h3>
            <button class="next-btn"><img src="../1 (1).Final/images/next.png" alt="Next"></button>
          </div>
          <ul class="product-list">
            <li>Blush</li>
            <li>Primer</li>
            <li>Concealer</li>
            <li>Finish Powder</li>
            <li>Contour & Highlighter</li>
            <li>Makeup Cleansing Balm</li>
            <li class="shop-all-link">Shop All Face</li>
          </ul>
        </div>
        <div class="category" data-category="Eyes">
          <div class="category-header">
            <h3><a href="#">EYES</a></h3>
            <button class="next-btn"><img src="../1 (1).Final/images/next.png" alt="Next"></button>
          </div>
          <ul class="product-list">
            <li>Makeup Palette</li>
            <li>Eyebrow Enhancer</li>
            <li>Mascara</li>
            <li>Eyeliner</li>
            <li class="shop-all-link">Shop All Eyes</li>
          </ul>
        </div>
        <div class="category" data-category="Lips">
          <div class="category-header">
            <h3><a href="#">LIPS</a></h3>
            <button class="next-btn"><img src="../1 (1).Final/images/next.png" alt="Next"></button>
          </div>
          <ul class="product-list">
            <li>Lip Cream</li>
            <li>Lipstick</li>
            <li>Lip Gloss</li>
            <li>Lip Lacquer</li>
            <li>Lip Glaze</li>
            <li>Lip Jelly</li>
            <li>Lip Mask</li>
            <li class="shop-all-link">Shop All Lips</li>
          </ul>
        </div>
      </div>
    </div>
  </nav>
</header>

<script>
document.addEventListener('DOMContentLoaded', () => {
  // Elements for header
  const menuToggler = document.getElementById('menu-toggler');
  const navbar = document.getElementById('navbar');
  const shopAll = document.querySelector('.shop-all');
  const menuCategories = document.querySelector('.menu-categories');
  const backBtn = document.querySelector('.back-btn');
  const nextButtons = document.querySelectorAll('.next-btn');
  const announcementWrapper = document.getElementById('announcementWrapper');
  const searchIcon = document.querySelector('.search .icon');
  const searchInput = document.getElementById('search-input-main');
  const searchOverlay = document.createElement('div');
  const searchWrapper = document.createElement('div');
  const searchInputOverlay = document.createElement('input');
  const closeSearch = document.createElement('button');

  // Setup search overlay
  searchOverlay.classList.add('search-overlay');
  searchWrapper.classList.add('search-wrapper');
  searchInputOverlay.classList.add('search-input');
  searchInputOverlay.placeholder = 'Search for...';
  closeSearch.classList.add('close-search');
  closeSearch.innerHTML = '&times;';
  searchWrapper.appendChild(searchInputOverlay);
  searchWrapper.appendChild(closeSearch);
  searchOverlay.appendChild(searchWrapper);
  document.body.appendChild(searchOverlay);

  // Debounce function for resize
  function debounce(func, wait) {
    let timeout;
    return function executedFunction(...args) {
      const later = () => {
        clearTimeout(timeout);
        func(...args);
      };
      clearTimeout(timeout);
      timeout = setTimeout(later, wait);
    };
  }

  // Toggle menu
  if (menuToggler && navbar) {
    menuToggler.addEventListener('click', (e) => {
      e.stopPropagation();
      const isActive = navbar.classList.contains('active');
      navbar.classList.toggle('active', !isActive);
      navbar.style.transition = 'transform 0.3s ease, opacity 0.3s ease';
      navbar.style.transform = isActive ? 'translateY(-100%)' : 'translateY(0)';
      navbar.style.opacity = isActive ? '0' : '1';
      document.body.style.overflow = isActive ? '' : 'hidden';
      if (!isActive) {
        if (shopAll) shopAll.classList.remove('active');
        if (menuCategories) {
          menuCategories.classList.remove('active');
          menuCategories.style.display = 'none';
          document.querySelectorAll('.category').forEach(cat => {
            cat.classList.remove('active');
            const productList = cat.querySelector('.product-list');
            if (productList) productList.style.display = 'none';
          });
        }
      } else {
        restoreScroll();
      }
    });

    // Click outside to close menu on mobile
    document.addEventListener('click', (e) => {
      if (
        window.innerWidth <= 900 &&
        !navbar.contains(e.target) &&
        !menuToggler.contains(e.target) &&
        navbar.classList.contains('active')
      ) {
        navbar.classList.remove('active');
        navbar.style.transform = 'translateY(-100%)';
        navbar.style.opacity = '0';
        if (shopAll) shopAll.classList.remove('active');
        if (menuCategories) {
          menuCategories.classList.remove('active');
          menuCategories.style.display = 'none';
          document.querySelectorAll('.category').forEach(cat => {
            cat.classList.remove('active');
            const productList = cat.querySelector('.product-list');
            if (productList) productList.style.display = 'none';
          });
        }
        restoreScroll();
      }
    });
  }

  // Toggle categories
  if (shopAll && menuCategories) {
    let timeoutId;

    const handleMouseEnter = () => {
      clearTimeout(timeoutId);
      if (window.innerWidth > 900) {
        menuCategories.style.display = 'block';
        menuCategories.style.opacity = '1';
        menuCategories.style.transform = 'translateY(0)';
        // Hiển thị tất cả product-list trên PC
        document.querySelectorAll('.category').forEach(cat => {
          cat.classList.add('active');
          const productList = cat.querySelector('.product-list');
          if (productList) productList.style.display = 'block';
        });
      }
    };

    const handleMouseLeave = () => {
      timeoutId = setTimeout(() => {
        if (window.innerWidth > 900) {
          menuCategories.style.display = 'none';
          menuCategories.style.opacity = '0';
          menuCategories.style.transform = 'translateY(-10px)';
          // Ẩn tất cả product-list khi rời chuột
          document.querySelectorAll('.category').forEach(cat => {
            cat.classList.remove('active');
            const productList = cat.querySelector('.product-list');
            if (productList) productList.style.display = 'none';
          });
        }
      }, 300);
    };

    if (window.innerWidth > 900) {
      shopAll.addEventListener('mouseenter', handleMouseEnter);
      shopAll.addEventListener('mouseleave', handleMouseLeave);
      menuCategories.addEventListener('mouseenter', handleMouseEnter);
      menuCategories.addEventListener('mouseleave', handleMouseLeave);
    }

    shopAll.addEventListener('click', (e) => {
      if (window.innerWidth <= 900) {
        e.preventDefault();
        e.stopPropagation();
        const isActive = shopAll.classList.contains('active');
        shopAll.classList.toggle('active', !isActive);
        menuCategories.classList.toggle('active', !isActive);
        menuCategories.style.display = menuCategories.classList.contains('active') ? 'flex' : 'none';
        menuCategories.style.transition = 'opacity 0.3s ease, transform 0.3s ease';
        menuCategories.style.opacity = isActive ? '0' : '1';
        menuCategories.style.transform = isActive ? 'translateY(-10px)' : 'translateY(0)';
        if (backBtn) {
          backBtn.style.display = menuCategories.classList.contains('active') ? 'flex' : 'none';
        }
      }
    });

    if (backBtn) {
      backBtn.addEventListener('click', (e) => {
        e.preventDefault();
        e.stopPropagation();
        shopAll.classList.remove('active');
        menuCategories.classList.remove('active');
        menuCategories.style.display = 'none';
        menuCategories.style.opacity = '0';
        menuCategories.style.transform = 'translateY(-10px)';
        backBtn.style.display = 'none';
        document.querySelectorAll('.category').forEach(cat => {
          cat.classList.remove('active');
          const productList = cat.querySelector('.product-list');
          if (productList) productList.style.display = 'none';
        });
        restoreScroll();
      });
    }

    function setupMobileCategoryInteractions() {
      nextButtons.forEach(btn => {
        btn.addEventListener('click', (e) => {
          e.stopPropagation();
          const category = btn.closest('.category');
          const isActive = category.classList.contains('active');
          document.querySelectorAll('.category').forEach(cat => {
            if (cat !== category) {
              cat.classList.remove('active');
              const productList = cat.querySelector('.product-list');
              if (productList) productList.style.display = 'none';
            }
          });
          category.classList.toggle('active', !isActive);
          const productList = category.querySelector('.product-list');
          if (productList) {
            productList.style.display = category.classList.contains('active') ? 'block' : 'none';
            productList.style.transition = 'opacity 0.3s ease';
            productList.style.opacity = category.classList.contains('active') ? '1' : '0';
          }
        });
      });

      document.querySelectorAll('.category-header').forEach(header => {
        header.addEventListener('click', (e) => {
          if (!e.target.closest('.next-btn') && !e.target.closest('a')) {
            e.stopPropagation();
            const category = header.closest('.category');
            const isActive = category.classList.contains('active');
            document.querySelectorAll('.category').forEach(cat => {
              if (cat !== category) {
                cat.classList.remove('active');
                const productList = cat.querySelector('.product-list');
                if (productList) productList.style.display = 'none';
              }
            });
            category.classList.toggle('active', !isActive);
            const productList = category.querySelector('.product-list');
            if (productList) {
              productList.style.display = category.classList.contains('active') ? 'block' : 'none';
              productList.style.transition = 'opacity 0.3s ease';
              productList.style.opacity = category.classList.contains('active') ? '1' : '0';
            }
          }
        });
      });
    }

    setupMobileCategoryInteractions();

    // Debounce resize event
    const handleResize = debounce(() => {
      if (window.innerWidth > 900) {
        shopAll.addEventListener('mouseenter', handleMouseEnter);
        shopAll.addEventListener('mouseleave', handleMouseLeave);
        menuCategories.addEventListener('mouseenter', handleMouseEnter);
        menuCategories.addEventListener('mouseleave', handleMouseLeave);
        shopAll.classList.remove('active');
        menuCategories.classList.remove('active');
        menuCategories.style.display = 'none';
        menuCategories.style.opacity = '0';
        menuCategories.style.transform = 'translateY(-10px)';
        if (backBtn) backBtn.style.display = 'none';
        document.querySelectorAll('.category').forEach(cat => {
          cat.classList.remove('active');
          const productList = cat.querySelector('.product-list');
          if (productList) productList.style.display = 'none';
        });
        navbar.classList.remove('active');
        navbar.style.transform = 'translateY(0)';
        navbar.style.opacity = '1';
        restoreScroll();
      } else {
        shopAll.removeEventListener('mouseenter', handleMouseEnter);
        shopAll.removeEventListener('mouseleave', handleMouseLeave);
        menuCategories.removeEventListener('mouseenter', handleMouseEnter);
        menuCategories.removeEventListener('mouseleave', handleMouseLeave);
        menuCategories.style.transform = 'translateY(0)';
        // Đảm bảo product-list ẩn trên mobile khi resize
        document.querySelectorAll('.category').forEach(cat => {
          cat.classList.remove('active');
          const productList = cat.querySelector('.product-list');
          if (productList) productList.style.display = 'none';
        });
      }
    }, 100);

    window.addEventListener('resize', handleResize);
  }

  function restoreScroll() {
    document.body.style.overflow = '';
  }

  // Announcement slide
  if (announcementWrapper) {
    let currentSlide = 0;
    const slides = announcementWrapper.children;
    let slideInterval;

    function startSlide() {
      slideInterval = setInterval(() => {
        currentSlide = (currentSlide + 1) % slides.length;
        announcementWrapper.style.transition = 'transform 0.8s ease-in-out';
        announcementWrapper.style.transform = `translateX(-${currentSlide * 100}%)`;
      }, 3000);
    }

    startSlide();

    announcementWrapper.addEventListener('mouseenter', () => {
      clearInterval(slideInterval);
    });

    announcementWrapper.addEventListener('mouseleave', () => {
      startSlide();
    });
  }

  // Search overlay
  if (searchIcon && searchInput) {
    searchIcon.addEventListener('click', () => {
      searchOverlay.classList.add('active');
      searchInputOverlay.focus();
      document.body.style.overflow = 'hidden';
    });

    closeSearch.addEventListener('click', () => {
      searchOverlay.classList.remove('active');
      document.body.style.overflow = '';
    });

    searchInputOverlay.addEventListener('input', () => {
      const query = searchInputOverlay.value.toLowerCase();
      searchInput.value = query;
      if (window.filterProducts) window.filterProducts(query);
    });
  }
});
</script>
</body>
</html>